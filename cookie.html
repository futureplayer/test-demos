
<!doctype html>
<html mip>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
    <title>cookie清理操作</title>
    <link rel="stylesheet" type="text/css" href="https://mipcache.bdstatic.com/static/v1/mip.css">
    <link rel="canonical" href="">
    <style mip-custom>
    </style>
</head>

<body>
	<p>原cookie大小：<span id="origin"></span></p>
	<p>现cookie大小：<span id="current"></span></p>
	<script src="./mip-cookie.js"></script>
	<script type="text/javascript">
		var str = 'a';
		for (var i = 0; i < 3 * 1024; i++) {
			str += 'a';
		};
		document.cookie = "name1=" + str + ';path=/;domain=' + window.location.hostname;
		document.cookie = "name2=" + str + ';path=/;domain=' + window.location.hostname;

		document.cookie = "name3=" + str + ';path=/;domain=' + window.location.hostname.split('.').slice(-2).join('.');
		document.cookie = "name4=" + str + ';path=/;domain=' + window.location.hostname.split('.').slice(-2).join('.');

		var origin = document.querySelector('#origin');
		var current = document.querySelector('#current');

		origin.innerText = document.cookie.length;

		var CustomStorage = require('util').customStorage;
		var storage = new CustomStorage(2);
        storage.delExceedCookie();

        setTimeout(function () {
        	current.innerText = document.cookie.length;
        }, 100);
	</script>
</body>
</html>
