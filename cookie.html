<!doctype html>
<html mip>
<head>
    <link rel="canonical" href="">
    <style mip-custom>
    </style>
</head>

<body>
    <p>原cookie大小：<span id="origin"></span></p>
    <p>现cookie大小：<span id="current"></span></p>
    <p>剩余cookie：<span id="cookie"></span></p>
    <script src="./mip-cookie.js"></script>
    <script type="text/javascript">
    var str = 'a';
    for (var i = 0; i < 0.1 * 1024; i++) {
        str += 'a';
    };
    setTimeout(function () {
        document.cookie = "name1=" + str + ';path=/;domain=' + window.location.hostname;
        console.log(111111 + ' : ' + document.cookie.length);
    }, 1000);
    setTimeout(function () {
        document.cookie = "name2=" + str + ';path=/;domain=' + window.location.hostname;
        console.log(222222 + ' : ' + document.cookie.length);
    }, 2000);
    setTimeout(function () {
        document.cookie = "name3=" + str + ';path=/;domain=' + window.location.hostname;
        console.log(3333333 + ' : ' + document.cookie.length);
    }, 3000);
    setTimeout(function () {
        document.cookie = "name4=" + str + ';path=/;domain=' + window.location.hostname;
        console.log(4444444 + ' : ' + document.cookie.length);
    }, 4000);

    var origin = document.querySelector('#origin');
    var current = document.querySelector('#current');
    var cookie = document.querySelector('#cookie');
    setTimeout(function () {
        console.log(55555555);
        console.log(document.cookie.length / 1024);
    }, 6000);

    setTimeout(function () {
        console.log(666666666);
        origin.innerText = document.cookie.length / 1024 + 'k';
        var CustomStorage = require('util').customStorage;
        // var storage = new CustomStorage(2);
        // storage.delExceedCookie();
    }, 7000);

    setTimeout(function() {
        console.log(7777777777);
        current.innerText = document.cookie.length / 1024 + 'k';
        cookie.innerText = document.cookie;
    }, 8000);
    </script>
</body>

</html>
